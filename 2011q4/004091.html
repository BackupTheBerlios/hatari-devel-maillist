<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [hatari-devel] WinUae CpuCore New patch with 3 important changes
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/hatari-devel/2011q4/index.html" >
   <LINK REL="made" HREF="mailto:hatari-devel%40lists.berlios.de?Subject=Re%3A%20%5Bhatari-devel%5D%20WinUae%20CpuCore%20New%20patch%20with%203%20important%20changes&In-Reply-To=%3C4E960A5A.4080506%40free.fr%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004090.html">
   <LINK REL="Next"  HREF="004092.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[hatari-devel] WinUae CpuCore New patch with 3 important changes</H1>
    <B>Laurent Sallafranque</B> 
    <A HREF="mailto:hatari-devel%40lists.berlios.de?Subject=Re%3A%20%5Bhatari-devel%5D%20WinUae%20CpuCore%20New%20patch%20with%203%20important%20changes&In-Reply-To=%3C4E960A5A.4080506%40free.fr%3E"
       TITLE="[hatari-devel] WinUae CpuCore New patch with 3 important changes">laurent.sallafranque at free.fr
       </A><BR>
    <I>Wed Oct 12 23:44:58 CEST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="004090.html">[hatari-devel] Merge to latest winuae core
</A></li>
        <LI>Next message: <A HREF="004092.html">[hatari-devel] WinUae CpuCore New patch with 3 important changes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4091">[ date ]</a>
              <a href="thread.html#4091">[ thread ]</a>
              <a href="subject.html#4091">[ subject ]</a>
              <a href="author.html#4091">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,

I've just uploaded a new patch for the winUae core.

I know I should have split this patch in 3 parts as it concerns 3 
different things, I apologize for that.

This patch does 3 things :

1) I've reintruduced the nCurInstrCycPos in all the cores and the call 
to M68000_AddCyclesWithPairing(cpu_cycles) in the 68000 core only.
Like this, there's less work to do now to upgrade the compatibility of 
this new core.

I've done some Atari St(FE) tests : some demo runs, some are not yet 
running, but it seems to be quite often the same problem (bus error at 
addr $7, ...)


2)  I've fixed all the cycle exact cpus.

Now these cpu's are running. Of course, I haven't yet implemented the 
cycle exact into thedifferent components of hatari.
I think we should try to reach thesame level of compatibility with the 
new core as we had with the old one before using the cycle exact.

Now, only the 68040 + MMU doest'n run.

I've found something strange : if I change the core while hatari is 
running (for example switching from 68030 to 68000), hatari doesn't 
reparameters correctly.
I have to save my new parameters into hatari.cfg, quit hatari and then 
restart it to allow the changes to be taken into account). This will 
have to be fixed.


3) I've found and corrected the problem with all the falcon demos and 
games that need to run at 32 Mhz only.

This fix EKo System, Are you experienced, Lost Blubb, Time out, Cebit93 
demo, outline 2006 intro, bounds42, watership,  ...)
I've tested all of them with 68030 CPU and prefetch mode activated.
I've tested some of them with 68030 no prefetch and some of them with 
68030 cycle exact.

Some of them still have some glitched or a noisy music, some other works 
well, but all runs when they were freezing before at 16 Mhz.

The problem was in the call of add_cycles (I shouldn't multiply the 
cycles by 2).

Could someone confirm that these programs run well now ?

Best regards

Laurent

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004090.html">[hatari-devel] Merge to latest winuae core
</A></li>
	<LI>Next message: <A HREF="004092.html">[hatari-devel] WinUae CpuCore New patch with 3 important changes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4091">[ date ]</a>
              <a href="thread.html#4091">[ thread ]</a>
              <a href="subject.html#4091">[ subject ]</a>
              <a href="author.html#4091">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/hatari-devel">More information about the hatari-devel
mailing list</a><br>
</body></html>
