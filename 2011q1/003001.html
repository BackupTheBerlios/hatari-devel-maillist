<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [hatari-devel] STE sound breakage with lower sound frequencies
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/hatari-devel/2011q1/index.html" >
   <LINK REL="made" HREF="mailto:hatari-devel%40lists.berlios.de?Subject=Re%3A%20%5Bhatari-devel%5D%20STE%20sound%20breakage%20with%20lower%20sound%20frequencies&In-Reply-To=%3C201102080015.38871.oak%40helsinkinet.fi%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002998.html">
   <LINK REL="Next"  HREF="003002.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[hatari-devel] STE sound breakage with lower sound frequencies</H1>
    <B>Eero Tamminen</B> 
    <A HREF="mailto:hatari-devel%40lists.berlios.de?Subject=Re%3A%20%5Bhatari-devel%5D%20STE%20sound%20breakage%20with%20lower%20sound%20frequencies&In-Reply-To=%3C201102080015.38871.oak%40helsinkinet.fi%3E"
       TITLE="[hatari-devel] STE sound breakage with lower sound frequencies">oak at helsinkinet.fi
       </A><BR>
    <I>Mon Feb  7 23:15:38 CET 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="002998.html">[hatari-devel] More precise VBL delays
</A></li>
        <LI>Next message: <A HREF="003002.html">[hatari-devel] STE sound breakage with lower sound frequencies
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3001">[ date ]</a>
              <a href="thread.html#3001">[ thread ]</a>
              <a href="subject.html#3001">[ subject ]</a>
              <a href="author.html#3001">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

On maanantai 07 helmikuu 2011, Nicolas Pomar&#232;de wrote:
&gt;<i> Le 06/02/2011 21:43, Eero Tamminen a &#233;crit :
</I>&gt;<i> &gt; This fixed the US TOS issue for ST TOS, but I just noticed a regression
</I>&gt;<i> &gt; for STE TOS.  There isn't anymore keyclick sound on STE desktop,
</I>&gt;<i> &gt; just a short sound on first key press and then silence...
</I>&gt;<i> 
</I>&gt;<i> That's surprising, I tested with 1.62fr and 1.62us and didn't notice
</I>&gt;<i> your problem ; do you get sound with a demo/game started from tos ?
</I>
I tried Utopos demo.

If I use &quot;--sound 11025&quot; or &quot;--sound 16000&quot;, there's just a short &quot;dup&quot;[1]
sound and then no sound at all.  With e.g. 22kHz or 48kHz, sound works fine
for STE emulation too.

The issue happens also for Hatari from end of december and for Hatari v1.4.
Keyclick on STE TOS works for Hatari v1.4 even at 11025Hz though.


[1] I hear it also if I open options dialog and then continue emulation.


&gt;<i> If you uncomment line 105-106 in main.c (to use SDL functions), does it
</I>&gt;<i> still happen ?
</I>
Doesn't help.


&gt;<i> &gt;&gt; nanosleep() and gettimeofday() are POSIX, so all conforming unixes
</I>&gt;<i> &gt;&gt; should have them (Linux and OSX for example).
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; As only the interval is interesting (not timezone etc corrected
</I>&gt;<i> &gt; wall clock time) why to use gettimeofday() instead of
</I>&gt;<i> &gt; clock_gettime(CLOCK_MONOTONIC,...)?
</I>&gt;<i> 
</I>&gt;<i> Because I wanted to have a function that works for OSX too, and
</I>&gt;<i> clock_gettime is not available up to OSX 10.6 at least from what I found
</I>&gt;<i> (it seems Apple didn't implement these posix extensions).
</I>
Ok, fair enough. :-)


&gt;<i> clock_gettime gives nanosec when reading it, but as long as we need only
</I>&gt;<i> microsec, it's not necessarily useful for our case.
</I>&gt;<i> 
</I>&gt;<i> Well, of course, if someone use settimeoday() while hatari is running,
</I>&gt;<i> this can mess with gettimeofday, but I'm not sure this is a real problem
</I>&gt;<i> ?
</I>
Well, the possible issue is quite theoretical, but can happen also not just
by explicit user time change, but e.g. by automatic switch to/from daylight
savings or due to NTP update.  NTP time corrections are typically so small
(say few secs) that Hatari wouldn't freeze for very long time though. :-)


	- Eero


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002998.html">[hatari-devel] More precise VBL delays
</A></li>
	<LI>Next message: <A HREF="003002.html">[hatari-devel] STE sound breakage with lower sound frequencies
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3001">[ date ]</a>
              <a href="thread.html#3001">[ thread ]</a>
              <a href="subject.html#3001">[ subject ]</a>
              <a href="author.html#3001">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/hatari-devel">More information about the hatari-devel
mailing list</a><br>
</body></html>
