<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [hatari-devel] Issues after restoring a memory snapshot
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/hatari-devel/2011q1/index.html" >
   <LINK REL="made" HREF="mailto:hatari-devel%40lists.berlios.de?Subject=Re%3A%20%5Bhatari-devel%5D%20Issues%20after%20restoring%20a%20memory%20snapshot&In-Reply-To=%3C201101281452.19433.oak%40helsinkinet.fi%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002921.html">
   <LINK REL="Next"  HREF="002859.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[hatari-devel] Issues after restoring a memory snapshot</H1>
    <B>Eero Tamminen</B> 
    <A HREF="mailto:hatari-devel%40lists.berlios.de?Subject=Re%3A%20%5Bhatari-devel%5D%20Issues%20after%20restoring%20a%20memory%20snapshot&In-Reply-To=%3C201101281452.19433.oak%40helsinkinet.fi%3E"
       TITLE="[hatari-devel] Issues after restoring a memory snapshot">oak at helsinkinet.fi
       </A><BR>
    <I>Fri Jan 28 13:52:19 CET 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="002921.html">[hatari-devel] Issues after restoring a memory snapshot
</A></li>
        <LI>Next message: <A HREF="002859.html">[hatari-devel] Issues after restoring a memory snapshot
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2923">[ date ]</a>
              <a href="thread.html#2923">[ thread ]</a>
              <a href="subject.html#2923">[ subject ]</a>
              <a href="author.html#2923">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

On perjantai 28 tammikuu 2011, Laurent Sallafranque wrote:
&gt;<i> I'm using the latest source code.
</I>
Likewise.


&gt;<i> With the WinUae core, everything works perfectly (the demo, opening and
</I>&gt;<i> closing the Option menu, saving and restoring a snapshot).
</I>&gt;<i> 
</I>&gt;<i> With the old UAE core, the demo does not start. It freezes on a very
</I>&gt;<i> large screen.
</I>&gt;<i> I've got the following message in the console : WARNING: too large
</I>&gt;<i> screen size 5120x240 -&gt; divided by 4x1!
</I>&gt;<i> 
</I>&gt;<i> Dsp waits forever at adress $88
</I>
If I run Mahab like this:
	src/hatari --machine st --tos tos404.img mahabhar/mahabhar.prg

So that Hatari starts as ST emulator and then switches to Falcon emulation 
on TOS load, the demo runs fine with UAE core.

Only if I use &quot;--machine falcon&quot;, the demo freezes at startup.

Adding just &quot;--dsp emu&quot; before it didn't affect anything, so it's not DSP
specific.

Using &quot;--machine tt&quot; caused the freeze also, so it's not specific to machine
type or frequency, but what are common between TT &amp; Falcon machine types:
- ConfigureParams.System.nCpuLevel = 3; 
- Use of Videl
- ???


Summary:
- init/reset HW as ST
- switch to Falcon on TOS load
  - init DSP &amp; IoMem &amp; rebuild CPU table &amp; reset HW as Falcon

works fine whereas just initializing HW as Falcon (or switching from TT 
emulation) doesn't produce working emulation for Mahab with AUE.


Btw. why DMA sound isn't reseted for Falcon emulation, only Crossbar?
Does Crossbar replace DmaSnd.c stuff completely?

(And why Crossbar sound has reset function, but no init function?)


	- Eero

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002921.html">[hatari-devel] Issues after restoring a memory snapshot
</A></li>
	<LI>Next message: <A HREF="002859.html">[hatari-devel] Issues after restoring a memory snapshot
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2923">[ date ]</a>
              <a href="thread.html#2923">[ thread ]</a>
              <a href="subject.html#2923">[ subject ]</a>
              <a href="author.html#2923">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/hatari-devel">More information about the hatari-devel
mailing list</a><br>
</body></html>
