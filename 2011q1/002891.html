<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [hatari-devel] Issues after restoring a memory snapshot
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/hatari-devel/2011q1/index.html" >
   <LINK REL="made" HREF="mailto:hatari-devel%40lists.berlios.de?Subject=Re%3A%20%5Bhatari-devel%5D%20Issues%20after%20restoring%20a%20memory%20snapshot&In-Reply-To=%3C201101262102.12221.oak%40helsinkinet.fi%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002879.html">
   <LINK REL="Next"  HREF="002892.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[hatari-devel] Issues after restoring a memory snapshot</H1>
    <B>Eero Tamminen</B> 
    <A HREF="mailto:hatari-devel%40lists.berlios.de?Subject=Re%3A%20%5Bhatari-devel%5D%20Issues%20after%20restoring%20a%20memory%20snapshot&In-Reply-To=%3C201101262102.12221.oak%40helsinkinet.fi%3E"
       TITLE="[hatari-devel] Issues after restoring a memory snapshot">oak at helsinkinet.fi
       </A><BR>
    <I>Wed Jan 26 20:02:12 CET 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="002879.html">[hatari-devel] Issues after restoring a memory snapshot
</A></li>
        <LI>Next message: <A HREF="002892.html">[hatari-devel] Issues after restoring a memory snapshot
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2891">[ date ]</a>
              <a href="thread.html#2891">[ thread ]</a>
              <a href="subject.html#2891">[ subject ]</a>
              <a href="author.html#2891">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

On keskiviikko 26 tammikuu 2011, Laurent Sallafranque wrote:
&gt;<i> I've just fixed the issue with crossbar saving / restoring memory
</I>&gt;<i> snapshot. I've tested with Mahab demo, and it runs for me.
</I>&gt;<i> 
</I>&gt;<i> Could you just do 1 or 2 tests to confirm there's nothing else missing ?
</I>
Unfortunately it still doesn't work for me properly.

I started Hatari like this:
	src/hatari --fast-forward yes --tos tos404.img mahabhar/mahabhar.prg

and saved a memory snapshot from the Memory dialog.

Then I tried the snapshot with:
	src/hatari --tos tos404.img --memstate maha.sav

Besides seeing the demo screen contents I only get a continuous &quot;diesel
engine&quot; sound that comes when the same audio buffer contents get re-played
and demo is frozen.

This happens even if I'm already running the Mahab demo and restore
an Mahab memory snapshot from the UI, so it doesn't seem like HW
initialization issue.  Some state just seems incorrectly restored.

The snapshot is from the first screen.


If I reset the emulation the &quot;diesel sound&quot; continues.  It disappears only
after second reset.  If I try to run the Mahab demo then, it freezes
the first time it resizes the screen to an extra wide size.

There's no store/restore for Videl values, but I didn't notice videl.c
having any state that wouldn't get set to right values when videl code is
used or being capable of freezing the demo.

(nvram.c lack of save &amp; restore could give inconsistent state, but that's
fairly harmless also.)


Btw. Sometimes I'm able to get the diesel sound just by opening the Hatari
Options dialog during Mahab demo.  I've seen that to happen only with Falcon
emulation.  Nicolas, maybe you have some comment to that?


	- Eero

PS.  I updated the memory snapshot version as adding Crossbar data into
it makes it incompatible with previous versions.

(By manually extending the data snapshot files suitably, one could still use
the old ST snapshots as the Falcon parts are at the end of the snapshot
file.)

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002879.html">[hatari-devel] Issues after restoring a memory snapshot
</A></li>
	<LI>Next message: <A HREF="002892.html">[hatari-devel] Issues after restoring a memory snapshot
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2891">[ date ]</a>
              <a href="thread.html#2891">[ thread ]</a>
              <a href="subject.html#2891">[ subject ]</a>
              <a href="author.html#2891">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/hatari-devel">More information about the hatari-devel
mailing list</a><br>
</body></html>
