<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [hatari-devel] Slow sound buffer
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/hatari-devel/2011q1/index.html" >
   <LINK REL="made" HREF="mailto:hatari-devel%40lists.berlios.de?Subject=Re%3A%20%5Bhatari-devel%5D%20Slow%20sound%20buffer&In-Reply-To=%3C4D355C79.1070502%40corp.free.fr%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002827.html">
   <LINK REL="Next"  HREF="002828.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[hatari-devel] Slow sound buffer</H1>
    <B>Nicolas Pomar&#232;de</B> 
    <A HREF="mailto:hatari-devel%40lists.berlios.de?Subject=Re%3A%20%5Bhatari-devel%5D%20Slow%20sound%20buffer&In-Reply-To=%3C4D355C79.1070502%40corp.free.fr%3E"
       TITLE="[hatari-devel] Slow sound buffer">npomarede at corp.free.fr
       </A><BR>
    <I>Tue Jan 18 10:25:13 CET 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="002827.html">[hatari-devel] Slow sound buffer
</A></li>
        <LI>Next message: <A HREF="002828.html">[hatari-devel] WinUae cycles and DSP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2829">[ date ]</a>
              <a href="thread.html#2829">[ thread ]</a>
              <a href="subject.html#2829">[ subject ]</a>
              <a href="author.html#2829">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Le 18/01/2011 06:39, David Savinkoff a &#233;crit :
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I found that making the timer delays more accurate helps with
</I>&gt;<i> sound synchronization. In Main_WaitOnVbl(void) of main.c
</I>&gt;<i> for example: nFrameDuration = 1000/nScreenRefreshRate
</I>&gt;<i> results in 16 milliseconds when nScreenRefreshRate is 60Hz
</I>&gt;<i> but it should be 16.66... This is a 100%*(16.66-16)/16 = 4.17%
</I>&gt;<i> syncronization mismatch at 60 Hz. Solved, but CPU ticks are
</I>&gt;<i> Not sound system sample rates (separate hardware with separate
</I>&gt;<i> crystals). Thus hatari Must do more, and that is done in sound.c
</I>&gt;<i>
</I>&gt;<i> //fprintf ( stderr, &quot;%d\n&quot;, nGeneratedSamples-len); was put in
</I>&gt;<i> audio.c to display excess samples count for experimenting.
</I>&gt;<i>
</I>&gt;<i> Problem solved and the sound is perfect!
</I>&gt;<i>
</I>&gt;<i> Sincerely,
</I>&gt;<i> David
</I>&gt;<i>
</I>
thanks, I will look at this later (I'm a little busy these days) and 
will try to commit some changes for video freq (it's indeed true that 
60Hz gives more rounding error than 50 Hz with the various output freq).

 From what I see, this improve rounding error for dma sound too, is that 
right ?


Nicolas

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002827.html">[hatari-devel] Slow sound buffer
</A></li>
	<LI>Next message: <A HREF="002828.html">[hatari-devel] WinUae cycles and DSP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2829">[ date ]</a>
              <a href="thread.html#2829">[ thread ]</a>
              <a href="subject.html#2829">[ subject ]</a>
              <a href="author.html#2829">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/hatari-devel">More information about the hatari-devel
mailing list</a><br>
</body></html>
