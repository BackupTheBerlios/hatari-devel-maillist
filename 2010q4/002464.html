<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [hatari-devel] Some news
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/hatari-devel/2010q4/index.html" >
   <LINK REL="made" HREF="mailto:hatari-devel%40lists.berlios.de?Subject=Re%3A%20%5Bhatari-devel%5D%20Some%20news&In-Reply-To=%3C4CACF699.6000109%40corp.free.fr%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002462.html">
   <LINK REL="Next"  HREF="002466.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[hatari-devel] Some news</H1>
    <B>Nicolas Pomar&#232;de</B> 
    <A HREF="mailto:hatari-devel%40lists.berlios.de?Subject=Re%3A%20%5Bhatari-devel%5D%20Some%20news&In-Reply-To=%3C4CACF699.6000109%40corp.free.fr%3E"
       TITLE="[hatari-devel] Some news">npomarede at corp.free.fr
       </A><BR>
    <I>Thu Oct  7 00:22:17 CEST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="002462.html">[hatari-devel] Some news
</A></li>
        <LI>Next message: <A HREF="002466.html">[hatari-devel] Some news
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2464">[ date ]</a>
              <a href="thread.html#2464">[ thread ]</a>
              <a href="subject.html#2464">[ subject ]</a>
              <a href="author.html#2464">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Le 06/10/2010 23:49, Thomas Huth a &#233;crit :

&gt;&gt;<i> I think it would be good also when modifying winuae's sources to not
</I>&gt;&gt;<i> remove amiga's specific code to put atari's one instead, but to keep
</I>&gt;&gt;<i> both with some conditionial defines.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> eg :
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> #ifedef HATARI_BUILD
</I>&gt;&gt;<i> ....&lt;new hatari code&gt;
</I>&gt;&gt;<i> #else
</I>&gt;&gt;<i> ....&lt;original amiga/winuae code&gt;
</I>&gt;&gt;<i> #endif
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This way we can keep track of all specific modifications made for
</I>&gt;&gt;<i> hatari and it will be much easier to backport future winuae's
</I>&gt;&gt;<i> improvements in hatari.
</I>&gt;<i>
</I>&gt;<i> Hmm, but that will render the WinUAE code even more unreadable than it
</I>&gt;<i> currently is?
</I>&gt;<i>
</I>&gt;<i> I think the best, but very time consuming solution would be to make all
</I>&gt;<i> those CPU core files as independent from the emulated system as
</I>&gt;<i> possible, and then to submit these patches upstream to WinUAE, but
</I>&gt;<i> whether they would accept such patches is another question...
</I>
That was my goal when suggesting to add some #ifdef, I don't know right 
now how many of these we should use, but I think it could be useful to 
see what we changed and submit these change to winuae (if not needed in 
the end, we could remove the ifdef later and keep only the hatari's part).
In the end, I'm not sure there're so many ifdef to put, so it shouldn't 
make code less unreadable (and after spending quite some time with it, I 
think it's quite readable in the end :) )

As to what we could submit to winuae, I don't really know. For example, 
I remember correcting some timings for d8(an,xn) addressing mode, but 
this is caused by the ST's bus, it wouldn't apply to the amiga.
Anyway, this can be sorted out later, first step is to build hatari 
against winuae. IMO, this is not the most complex part, it's the timing 
issues related to overscan/pairing and specific to the ST's bus that may 
proove difficult to implement with a little modification as possible in 
winuae.

Falcon mode + winuae core should be less difficult to use, because the 
falcon doesn't rely on such cycle exact emulation as the ST. Winuae 
changes will be more noticeable in falcon mode as they add some missing 
functionnality for a real 68030 emulation for now.

Nicolas

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002462.html">[hatari-devel] Some news
</A></li>
	<LI>Next message: <A HREF="002466.html">[hatari-devel] Some news
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2464">[ date ]</a>
              <a href="thread.html#2464">[ thread ]</a>
              <a href="subject.html#2464">[ subject ]</a>
              <a href="author.html#2464">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/hatari-devel">More information about the hatari-devel
mailing list</a><br>
</body></html>
