<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [hatari-devel] Two Hatari bugs
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/hatari-devel/2011q2/index.html" >
   <LINK REL="made" HREF="mailto:hatari-devel%40lists.berlios.de?Subject=Re%3A%20%5Bhatari-devel%5D%20Two%20Hatari%20bugs&In-Reply-To=%3Calpine.DEB.2.00.1105141844220.15416%40gem.atari.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003434.html">
   <LINK REL="Next"  HREF="003436.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[hatari-devel] Two Hatari bugs</H1>
    <B>Anders Eriksson</B> 
    <A HREF="mailto:hatari-devel%40lists.berlios.de?Subject=Re%3A%20%5Bhatari-devel%5D%20Two%20Hatari%20bugs&In-Reply-To=%3Calpine.DEB.2.00.1105141844220.15416%40gem.atari.org%3E"
       TITLE="[hatari-devel] Two Hatari bugs">ae at dhs.nu
       </A><BR>
    <I>Sat May 14 18:48:05 CEST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="003434.html">[hatari-devel] Two Hatari bugs
</A></li>
        <LI>Next message: <A HREF="003436.html">[hatari-devel] Two Hatari bugs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3435">[ date ]</a>
              <a href="thread.html#3435">[ thread ]</a>
              <a href="subject.html#3435">[ subject ]</a>
              <a href="author.html#3435">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sat, 14 May 2011, Nicolas Pomar&#232;de wrote:

&gt;<i> Do you mean reg 13 in the YM file is never set to 0xff, or the opposite ?
</I>&gt;<i>
</I>&gt;<i> From the code in ymformat.c, we have :
</I>&gt;<i>
</I>&gt;<i>                if (bEnvelopeFreqFlag)
</I>&gt;<i>                        *pYMData++ = SoundRegs[PSG_REG_ENV_SHAPE];
</I>&gt;<i>                else
</I>&gt;<i>                        *pYMData++ = 0xff;
</I>&gt;<i>
</I>&gt;<i> I tried recording an YM from the GEM desktop and reg 13 is always 0xff in the 
</I>&gt;<i> YM file.
</I>&gt;<i>
</I>&gt;<i> Same in the 2 files you sent, reg 13 is always 0xff ; are you sure those 
</I>&gt;<i> tunes don't use mfp timer to change reg 13 ? Because in that case it clearly 
</I>&gt;<i> won't work in Hatari's ym dumping.
</I>
Hi,

I think I wasn't clear enough, here's from the YM3! file format 
description:

&quot;SPECIAL: Register 13 !
----------------------

 	Creating a binary with YM registers for each VBL is easy. However
there is special case concerning register 13. Reg13 is used for the volume
envelope wave-form on the YM2149. The problem is writing to that register
&quot;restarts&quot; the wave-form at beginning. That is, you CAN'T access this 
regis-
ter each VBL if the original play-routine does not. So, if the original
player does not write to register 13 on VBL n, write 0xff value.
(So when YM.EXE read 0xff as reg13, the internal emulator register is not
updated).&quot;

<A HREF="http://www.mirkoroller.mynetcologne.de/ym2149hard/ym3.format">http://www.mirkoroller.mynetcologne.de/ym2149hard/ym3.format</A>


As I understand it, reg 13 should only be $ff if the Atari has not 
accessed it during the VBL.

--
Anders Eriksson
<A HREF="https://lists.berlios.de/mailman/listinfo/hatari-devel">ae at dhs.nu</A>     <A HREF="http://www.dhs.nu/">http://www.dhs.nu/</A>
<A HREF="https://lists.berlios.de/mailman/listinfo/hatari-devel">ae at atari.org</A>  <A HREF="http://www.atari.org/">http://www.atari.org/</A>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003434.html">[hatari-devel] Two Hatari bugs
</A></li>
	<LI>Next message: <A HREF="003436.html">[hatari-devel] Two Hatari bugs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3435">[ date ]</a>
              <a href="thread.html#3435">[ thread ]</a>
              <a href="subject.html#3435">[ subject ]</a>
              <a href="author.html#3435">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/hatari-devel">More information about the hatari-devel
mailing list</a><br>
</body></html>
