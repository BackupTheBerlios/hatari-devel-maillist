<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [hatari-devel] Hatari crashes with Mental Hangover demo
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/hatari-devel/2011q2/index.html" >
   <LINK REL="made" HREF="mailto:hatari-devel%40lists.berlios.de?Subject=Re%3A%20%5Bhatari-devel%5D%20Hatari%20crashes%20with%20Mental%20Hangover%20demo&In-Reply-To=%3C20110501203809.0f4d1ded%40think43%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003382.html">
   <LINK REL="Next"  HREF="003375.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[hatari-devel] Hatari crashes with Mental Hangover demo</H1>
    <B>Thomas Huth</B> 
    <A HREF="mailto:hatari-devel%40lists.berlios.de?Subject=Re%3A%20%5Bhatari-devel%5D%20Hatari%20crashes%20with%20Mental%20Hangover%20demo&In-Reply-To=%3C20110501203809.0f4d1ded%40think43%3E"
       TITLE="[hatari-devel] Hatari crashes with Mental Hangover demo">huth at users.berlios.de
       </A><BR>
    <I>Sun May  1 20:38:09 CEST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="003382.html">[hatari-devel] Hatari crashes with Mental Hangover demo
</A></li>
        <LI>Next message: <A HREF="003375.html">[hatari-devel] Could somebody check Zero-5 on real STE?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3386">[ date ]</a>
              <a href="thread.html#3386">[ thread ]</a>
              <a href="subject.html#3386">[ subject ]</a>
              <a href="author.html#3386">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Am Sat, 30 Apr 2011 20:29:53 +0200
schrieb Nicolas Pomar&#232;de &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/hatari-devel">npomarede at corp.free.fr</A>&gt;:

&gt;<i> Le 30/04/2011 20:16, Eero Tamminen a &#233;crit :
</I>...
&gt;<i> &gt;&gt;&gt; PS. While doing the patches, I noticed:
</I>&gt;<i> &gt;&gt;&gt; $ grep HDCSectorCount $(find . -type f)
</I>&gt;<i> &gt;&gt;&gt; ./hdc.h:extern short int HDCSectorCount;
</I>&gt;<i> &gt;&gt;&gt; ./hdc.c:short int HDCSectorCount;
</I>&gt;<i> &gt;&gt;&gt; ./hdc.c:       fprintf(hdlogFile, &quot;HDC sector count: 0x%x\n&quot;,
</I>&gt;<i> &gt;&gt;&gt; HDCSectorCount);
</I>&gt;<i> &gt;&gt;&gt; ./fdc.c:       HDCSectorCount = 0;
</I>&gt;<i> &gt;&gt;&gt; ./fdc.c:               DMAStatus_ff8606rd |=
</I>&gt;<i> &gt;&gt;&gt; (HDCSectorCount)?0x2:0; /* HDC */
</I>&gt;<i> &gt;&gt;&gt; ./fdc.c:               DiskControllerByte = HDCSectorCount;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; What's the point in sector count that's never non-zero?
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; What do you mean exactly ?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;  From above you can see that &quot;HDCSectorCount&quot; can never get any
</I>&gt;<i> &gt; other value than zero (unlike e.g. FDCSectorCountRegister which
</I>&gt;<i> &gt; seems to be used for similar purpose).  So what's the point in
</I>&gt;<i> &gt; having that variable?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; hdc.c code gets the HDC sector count with this macro, it doesn't use
</I>&gt;<i> &gt; the variable:
</I>&gt;<i> &gt; #define HD_SECTORCOUNT(a) (a.command[4]&amp;  0xFF)        /* get
</I>&gt;<i> &gt; sector count */
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; How the fdc.c&amp;  hdc.c interact is quite ugly as fdc.c uses hdc.c
</I>&gt;<i> &gt; variables directly instead of there being HDC_* functions for this
</I>&gt;<i> &gt; stuff:
</I>&gt;<i> 
</I>&gt;<i> Well, I can't speak for hdc.c, I never touched this part of the code.
</I>&gt;<i> I guess it comes from Thomas and he certainly wanted to use the same
</I>&gt;<i> logic in hdc.c than in fdc.c, which could explain some unused
</I>&gt;<i> variables in the end.
</I>
hdc.c originally hasn't been written by me but by Sven de Marothy...
Dunno why this variable isn't used (anymore)? Maybe it was used in the
past, or it is not necessary since the ACSI commands are executed
immediately instead of delayed like the FDC commands?

 Thomas

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003382.html">[hatari-devel] Hatari crashes with Mental Hangover demo
</A></li>
	<LI>Next message: <A HREF="003375.html">[hatari-devel] Could somebody check Zero-5 on real STE?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3386">[ date ]</a>
              <a href="thread.html#3386">[ thread ]</a>
              <a href="subject.html#3386">[ subject ]</a>
              <a href="author.html#3386">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/hatari-devel">More information about the hatari-devel
mailing list</a><br>
</body></html>
