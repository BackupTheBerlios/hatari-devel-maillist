<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [hatari-devel] Code-review, unit tests and bug-tracker
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/hatari-devel/2011q2/index.html" >
   <LINK REL="made" HREF="mailto:hatari-devel%40lists.berlios.de?Subject=Re%3A%20%5Bhatari-devel%5D%20Code-review%2C%20unit%20tests%20and%20bug-tracker&In-Reply-To=%3C201105110004.34784.eerot%40users.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003410.html">
   <LINK REL="Next"  HREF="003415.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[hatari-devel] Code-review, unit tests and bug-tracker</H1>
    <B>Eero Tamminen</B> 
    <A HREF="mailto:hatari-devel%40lists.berlios.de?Subject=Re%3A%20%5Bhatari-devel%5D%20Code-review%2C%20unit%20tests%20and%20bug-tracker&In-Reply-To=%3C201105110004.34784.eerot%40users.berlios.de%3E"
       TITLE="[hatari-devel] Code-review, unit tests and bug-tracker">eerot at users.berlios.de
       </A><BR>
    <I>Tue May 10 23:04:34 CEST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="003410.html">[hatari-devel] Code-review, unit tests and bug-tracker
</A></li>
        <LI>Next message: <A HREF="003415.html">[hatari-devel] Code-review, unit tests and bug-tracker
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3411">[ date ]</a>
              <a href="thread.html#3411">[ thread ]</a>
              <a href="subject.html#3411">[ subject ]</a>
              <a href="author.html#3411">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

On tiistai 10 toukokuu 2011, Deniz Turkoglu wrote:
&gt;<i> On Mon, May 9, 2011 at 10:41 PM, Eero Tamminen &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/hatari-devel">eerot at users.berlios.de</A>&gt; &gt; 
</I>&gt;<i> On lauantai 07 toukokuu 2011, Deniz Turkoglu wrote:
</I>&gt;<i> &gt;&gt; I have been following the list for sometime and now I have the time to
</I>&gt;<i> &gt;&gt; contribute more, at least I hope so :) I have a few
</I>&gt;<i> &gt;&gt; questions/suggestions, mainly based on the flow we use at work;
</I>&gt;<i> &gt;&gt; 
</I>&gt;<i> &gt;&gt; - We use ReviewBoard <A HREF="http://www.reviewboard.org/">http://www.reviewboard.org/</A> at work. I think this
</I>&gt;<i> &gt;&gt; is nice for a few reasons. It makes discussing on changes easier and
</I>&gt;<i> &gt;&gt; you can associate changes with bugs and end results tends to be
</I>&gt;<i> &gt;&gt; better. I think this would speed up the discussion that goes on
</I>&gt;<i> &gt;&gt; patches?
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; If BerliOS will support reviewboard, why not.
</I>&gt;<i> 
</I>&gt;<i> It doesn't seem to have it.
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://www.berlios.de/developers.php.en">http://www.berlios.de/developers.php.en</A>
</I>&gt;<i> 
</I>&gt;<i> &gt;&gt; - I tried the bug tracker to have a go at things but seems it is not
</I>&gt;<i> &gt;&gt; as active as the mailing list, maybe we need another bug tracker, like
</I>&gt;<i> &gt;&gt; bugzilla or trac?
</I>
Btw. why/how changing the bug tracker would help?

E.g. bugzilla sends better bug mails and is otherwise nicer if everything
would go through bug tracker, but stuff seems to work fine on devel list
too.


&gt;<i> &gt; You can file bugs/tickets for BerliOS bug tracker itself too I assume.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Or were you proposing on hosting reviewboard and bug tracking services
</I>&gt;<i> &gt; for Hatari yourself?
</I>&gt;<i> 
</I>&gt;<i> The bug tracker and reviewboard can be hosted elsewhere of course. I
</I>&gt;<i> have shared hosting and can give it a go, it is not a fancy hosting
</I>&gt;<i> company though, so maybe setting up a home server is a better option.
</I>
I'd rather like BerliOS facilities to be enhanced...


[...]
&gt;<i> &gt; Main bulk of Hatari testing is running different (hundreds of) Atari
</I>&gt;<i> &gt; ST, STE and Falcon programs and just checking whether their output
</I>&gt;<i> &gt; looks OK without (much) need to compare it to real HW though.  And
</I>&gt;<i> &gt; checking that the output hasn't regressed.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; If you want to look into that, you should try &quot;hconsole&quot; python program
</I>&gt;<i> &gt; in tools/hconsole/ and try the Hatari remote API on how you
</I>&gt;<i> &gt; automate[1] running of the tests (ST/STE/Falcon demos).  Through that
</I>&gt;<i> &gt; you could e.g. run demos and record sound output &amp; get screenshots[1]
</I>&gt;<i> &gt; from them.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Comparing the sound files could be a bit inconvenient because 1-1 file
</I>&gt;<i> &gt; compare probably isn't the best thing (you'd catch changes, not whether
</I>&gt;<i> &gt; they're regressions).  I think for screenshots 1-1 checking should be
</I>&gt;<i> &gt; fine for catching regressions though.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; [1]  Automating other things than demos would probably require adding
</I>&gt;<i> &gt;    support for positioning Atari mouse on some specific co-ordinate
</I>&gt;<i> &gt;    on Atari screen.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;    To get them screenshots etc at suitable time in the demo, adding
</I>&gt;<i> &gt; some kind of &quot;pause at VBL n from start/now&quot; functionality to Hatari
</I>&gt;<i> &gt; might be needed.  Or &quot;dump screenshot at exit&quot; coupled with
</I>&gt;<i> &gt; &quot;--run-vbls&quot; option, if one screenshot per demo is enough.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;   Somehow detecting bus errors and other emulated Atari exceptions
</I>&gt;<i> &gt;   through the remote API could also be useful.
</I>&gt;<i> 
</I>&gt;<i> Perfect, I have done some work on this area, it turned out to be
</I>&gt;<i> harder than it looked at first sight :)
</I>&gt;<i> 
</I>&gt;<i> Screenshots: we hash the buffer and do a compare on host (i.e: hashes
</I>&gt;<i> are sent to hatari and if it matches any it is a pass, else we
</I>&gt;<i> compress to png and send it over the wire.
</I>
Screenshots don't go over the socket, they go to Hatari's current directory.
Taking them is what you can trigger over remote API.


&gt;<i> This is probably not very
</I>&gt;<i> useful for hatari as is since timing issues with frames are always a
</I>&gt;<i> problem, esp. considering different OS and devices. The idea to add
</I>&gt;<i> pause functionality sounds like a very good idea to solve this
</I>&gt;<i> bottleneck.
</I>&gt;<i> 
</I>&gt;<i> Mouse/keyboard interaction: there are 2 options with this one, we can
</I>&gt;<i> either fake it within hatari or we can directly do it within OS level,
</I>
Hatari already supports triggering key events and mouse button presses
through the remote API.

The thing lacking is moving the mouse, but that should mainly be needed just
for GEM stuff.  And emulating GEM stuff shouldn't be a problem like
emulating demos, so I think it can be mostly ignored...


&gt;<i> both has its ups and downs, if we fake it we can not be sure if the
</I>&gt;<i> cursor really moved, was visible on screen etc.. If we do it natively
</I>&gt;<i> it requires to port to every single OS that we run on. Also one neat
</I>&gt;<i> part about doing it hatari level is that it can compile and run tests
</I>&gt;<i> and you can still work on the computer at the same time,
</I>
It should also be more reliable (exactly the same events), host -&gt; SDL -&gt; 
Hatari event parsing timing issues cannot affect the movement events.


&gt;<i> will have a look at this and how feasible it is.
</I>&gt;<i> 
</I>&gt;<i> Audio: This one is rather tricky and I haven't done it before, 1-1
</I>&gt;<i> compare using the hash method can help with the regression, for
</I>&gt;<i> instance if we have a blacklist of hashes (regressions) we can find
</I>&gt;<i> out the root cause easier. Comments on this are more than welcome :)
</I>
The screenshots &amp; sound output are files saved by Hatari.  The control
socket is a local unix socket, not a tcp/ip one.  I don't understand what
you mean by &quot;hashes&quot;?


	- Eero

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003410.html">[hatari-devel] Code-review, unit tests and bug-tracker
</A></li>
	<LI>Next message: <A HREF="003415.html">[hatari-devel] Code-review, unit tests and bug-tracker
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3411">[ date ]</a>
              <a href="thread.html#3411">[ thread ]</a>
              <a href="subject.html#3411">[ subject ]</a>
              <a href="author.html#3411">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/hatari-devel">More information about the hatari-devel
mailing list</a><br>
</body></html>
