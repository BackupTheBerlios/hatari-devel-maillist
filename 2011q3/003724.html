<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [hatari-devel] Moai demo as regressed a lot since hatari 1.4
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/hatari-devel/2011q3/index.html" >
   <LINK REL="made" HREF="mailto:hatari-devel%40lists.berlios.de?Subject=Re%3A%20%5Bhatari-devel%5D%20Moai%20demo%20as%20regressed%20a%20lot%20since%20hatari%201.4&In-Reply-To=%3C4E1EB34B.6070304%40corp.free.fr%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003722.html">
   <LINK REL="Next"  HREF="003725.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[hatari-devel] Moai demo as regressed a lot since hatari 1.4</H1>
    <B>Nicolas Pomar&#232;de</B> 
    <A HREF="mailto:hatari-devel%40lists.berlios.de?Subject=Re%3A%20%5Bhatari-devel%5D%20Moai%20demo%20as%20regressed%20a%20lot%20since%20hatari%201.4&In-Reply-To=%3C4E1EB34B.6070304%40corp.free.fr%3E"
       TITLE="[hatari-devel] Moai demo as regressed a lot since hatari 1.4">npomarede at corp.free.fr
       </A><BR>
    <I>Thu Jul 14 11:13:47 CEST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="003722.html">[hatari-devel] Moai demo as regressed a lot since hatari 1.4
</A></li>
        <LI>Next message: <A HREF="003725.html">[hatari-devel] Moai demo as regressed a lot since hatari 1.4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3724">[ date ]</a>
              <a href="thread.html#3724">[ thread ]</a>
              <a href="subject.html#3724">[ subject ]</a>
              <a href="author.html#3724">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Le 14/07/2011 10:22, Laurent Sallafranque a &#233;crit :
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I've reverted the patch in dsp.c :: run to apply the rev 3144 patch
</I>&gt;<i> (just to see)
</I>&gt;<i>
</I>&gt;<i> With new cpu, it's KO (it was expected)
</I>&gt;<i> with old cpu and the latest release source, it works perfectly well.
</I>&gt;<i> (demo + music)
</I>&gt;<i>
</I>&gt;<i> So, this demo frezees because of timing between CPU and DSP transfers.
</I>&gt;<i> (I think that the 68030 CPU timings are better but still not perfect in
</I>&gt;<i> new winuae core).
</I>&gt;<i>
</I>&gt;<i> For example :
</I>&gt;<i> I don't know if winUae core (68030) takes into account that a real atari
</I>&gt;<i> Falcon has a 16 bits bus and not a 32 bits bus.
</I>&gt;<i> (this generates more waitstates cycles when reading/writing to odd
</I>&gt;<i> addressses or to non 4 bytes aligned memories in .L and .W access)
</I> &gt;
 &gt; Do you know if there's a parameter in winuae core that allows to tell
 &gt; we're using on a 16 bits BUS ?

Hello

I don't think winuae has such parameter, it's too atari's specific.

&gt;<i> If not, do you think it's easy to implement ? (I don't think so, but I
</I>&gt;<i> don't understand the 68x00 part of hatari well enough for now).
</I>&gt;<i>
</I>&gt;<i> This may probably be a part of the answear (cycles and precision problems).
</I>
I don't know if it's easy to implement, STF has a kind &quot;add wait state&quot; 
that works similarly, but 68030 could be quite different.

But I thought it was discussed and confirmed by other falcon's coders 
that transfer between cpu and dsp were often using some kind of 
handshake method, so I'm really not sure that &quot;ultimate&quot; cycle precision 
is the answer to this problem.

I mean, look at dma sound for STE, nothing had to be modified in the 
68000's emulation to improve quality, but there were really some parts 
of the dma that were not correctly emulated.

We should have some simple programs to test these, once again, unless we 
have them I think it will never work ; adapting Hatari's behaviour to 
such or such demo is not a long term solution and it just merge 
different complex issues in one single perceived problem (the sound 
quality).

For example, what about writing a test program similar to the STE's one 
I sent to play &quot;simple&quot; sound (no dsp involved) with the crossbar at 
different frequencies and ensure we get correct results ? (that's is the 
correct number of samples is *exactly* played for a number of VBL) If 
it's not the case, then it would prove something is wrong and that is 
not cpu related.


Nicolas

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003722.html">[hatari-devel] Moai demo as regressed a lot since hatari 1.4
</A></li>
	<LI>Next message: <A HREF="003725.html">[hatari-devel] Moai demo as regressed a lot since hatari 1.4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3724">[ date ]</a>
              <a href="thread.html#3724">[ thread ]</a>
              <a href="subject.html#3724">[ subject ]</a>
              <a href="author.html#3724">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/hatari-devel">More information about the hatari-devel
mailing list</a><br>
</body></html>
